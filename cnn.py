# -*- coding: utf-8 -*-
"""train_cnn.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1QXdMP3l6eU57S2Yu4kW33tLSEeU1js5c
"""

from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Conv1D, MaxPooling1D, Flatten, Dense, Dropout, Input
from tensorflow.keras import optimizers

def train_cnn(X_train, y_train, input_shape):
    """
    Melatih model CNN.
    """
    model = Sequential([
        Input(shape=(input_shape[1], 1)),
        Conv1D(32, kernel_size=3, activation='relu'),
        MaxPooling1D(pool_size=2),
        Dropout(0.3),
        Conv1D(64, kernel_size=3, activation='relu'),
        MaxPooling1D(pool_size=2),
        Dropout(0.3),
        Flatten(),
        Dense(128, activation='relu'),
        Dropout(0.5),
        Dense(1, activation='sigmoid')
    ])

    model.compile(optimizer='adam', loss='binary_crossentropy', metrics=['accuracy'])
    model.fit(X_train, y_train, epochs=15, batch_size=128, validation_split=0.2, verbose=1)

    return model

def evaluate_cnn(model, X_test, y_test):
    """
    Mengevaluasi model CNN.
    """
    loss, accuracy = model.evaluate(X_test, y_test)
    return accuracy